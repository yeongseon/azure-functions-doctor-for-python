[
  {
    "id": "check_python_version",
    "category": "environment",
    "section": "python_env",
    "label": "Python version",
    "description": "Checks if the current Python version is 3.9 or higher.",
    "type": "compare_version",
    "required": true,
    "severity": "error",
    "condition": {
      "target": "python",
      "operator": ">=",
      "value": "3.9"
    },
    "hint": "Use Python 3.9 or higher as required by Azure Functions Python v2.",
    "hint_url": "https://learn.microsoft.com/en-us/azure/azure-functions/functions-reference-python#supported-python-versions",
    "fix_command": "pyenv install 3.9.18",
    "check_order": 1
  },
  {
    "id": "check_programming_model_v2",
    "category": "project_structure",
    "section": "programming_model",
    "label": "Programming model v2",
    "description": "Confirms the project appears to use the v2 decorator-based programming model.",
    "type": "source_code_contains",
    "required": true,
    "severity": "info",
    "condition": {
      "keyword": "@app."
    },
    "check_order": 0
  },
  {
    "id": "check_venv",
    "category": "environment",
    "section": "python_env",
    "label": "Virtual environment",
    "description": "Checks if a virtual environment is activated.",
    "type": "env_var_exists",
    "required": true,
    "severity": "warning",
    "condition": {
      "target": "VIRTUAL_ENV"
    },
    "hint": "Activate a virtual environment using: 'source venv/bin/activate'.",
    "hint_url": "https://learn.microsoft.com/en-us/azure/azure-functions/functions-best-practices?tabs=python#use-virtual-environments",
    "check_order": 2
  },
  {
    "id": "check_python_executable",
    "category": "environment",
    "section": "python_env",
    "label": "Python executable",
    "description": "Checks if Python executable path exists.",
    "type": "path_exists",
    "required": true,
    "severity": "error",
    "condition": {
      "target": "sys.executable"
    },
    "hint": "Ensure Python is installed and sys.executable points to a valid path.",
    "hint_url": "https://learn.microsoft.com/en-us/azure/azure-functions/functions-reference-python#python-version-and-package-management",
    "check_order": 3
  },
  {
    "id": "check_requirements_txt",
    "category": "dependencies",
    "section": "python_env",
    "label": "requirements.txt",
    "description": "Checks if requirements.txt file exists at the root.",
    "type": "file_exists",
    "required": true,
    "severity": "error",
    "condition": {
      "target": "requirements.txt"
    },
    "hint": "Add a requirements.txt file to specify your dependencies.",
    "hint_url": "https://learn.microsoft.com/en-us/azure/azure-functions/functions-reference-python#managing-dependencies",
    "fix_command": "pip freeze > requirements.txt",
    "check_order": 4
  },
  {
    "id": "check_azure_functions_library",
    "category": "dependencies",
    "section": "python_env",
    "label": "azure-functions-python-library package",
    "description": "Checks if 'azure-functions-python-library' is installed (required for v2 programming model).",
    "type": "package_installed",
    "required": true,
    "severity": "error",
    "condition": {
      "pypi": "azure-functions-python-library",
      "target": "azure.functions"
    },
    "hint": "Install it with: pip install azure-functions-python-library",
    "hint_url": "https://learn.microsoft.com/en-us/azure/azure-functions/functions-reference-python?tabs=asgi&pivots=python-mode-decorators#azure-functions-python-library",
    "fix_command": "pip install azure-functions-python-library",
    "check_order": 5
  },
  {
    "id": "check_host_json",
    "category": "structure",
    "section": "project_structure",
    "label": "host.json",
    "description": "Checks if host.json file exists in the root directory.",
    "type": "file_exists",
    "required": true,
    "severity": "error",
    "condition": {
      "target": "host.json"
    },
    "hint": "host.json is required for configuring Azure Functions host runtime.",
    "hint_url": "https://learn.microsoft.com/en-us/azure/azure-functions/functions-host-json",
    "check_order": 7
  },
  {
    "id": "check_local_settings",
    "category": "structure",
    "section": "project_structure",
    "label": "local.settings.json",
    "description": "Checks if local.settings.json exists (useful for local development).",
    "type": "file_exists",
    "condition": {
      "target": "local.settings.json"
    },
    "required": false,
    "severity": "info",
    "hint": "Create local.settings.json for local development if needed.",
    "check_order": 7
  }
  ,
  {
    "id": "check_func_cli",
    "category": "tooling",
    "section": "tooling",
    "label": "Azure Functions Core Tools (func)",
    "description": "Checks if the Azure Functions Core Tools CLI ('func') is available on PATH.",
    "type": "executable_exists",
    "required": false,
    "severity": "warning",
    "condition": {
      "target": "func"
    },
    "hint": "Install Azure Functions Core Tools for local development and testing.",
    "hint_url": "https://learn.microsoft.com/en-us/azure/azure-functions/functions-run-local#v4",
    "check_order": 20
  },
  {
    "id": "check_durabletask_config",
    "category": "configuration",
    "section": "durable",
    "label": "Durable Functions configuration",
    "description": "Checks for durableTask configuration in host.json when durable functions are present.",
    "type": "conditional_exists",
    "required": false,
    "severity": "error",
    "condition": {
      "target": "host.json",
      "jsonpath": "$.extensions.durableTask"
    },
    "hint": "If using Durable Functions, ensure durableTask settings and required extensions are configured in host.json.",
    "hint_url": "https://learn.microsoft.com/azure/azure-functions/durable/durable-functions-overview",
    "check_order": 21
  },
  {
    "id": "check_http_trigger_bindings",
    "category": "bindings",
    "section": "http",
    "label": "HTTP trigger validation",
    "description": "Validate common HTTP trigger binding fields like authLevel, methods, and route across functions.",
    "type": "binding_validation",
    "required": false,
    "severity": "error",
    "condition": {},
    "hint": "Validate httpTrigger bindings for correct authLevel and methods to avoid security or routing issues.",
    "hint_url": "https://learn.microsoft.com/azure/azure-functions/functions-bindings-http-webhook-trigger?tabs=python",
    "check_order": 22
  },
  {
    "id": "check_timer_cron",
    "category": "bindings",
    "section": "timer",
    "label": "Timer trigger CRON validation",
    "description": "Validate timer trigger schedule values and CRON expression format.",
    "type": "cron_validation",
    "required": false,
    "severity": "error",
    "condition": {},
    "hint": "Ensure CRON expressions are valid for Azure Functions (consider 6-field vs 5-field formats).",
    "hint_url": "https://learn.microsoft.com/azure/azure-functions/functions-bindings-timer?tabs=python",
    "check_order": 23
  },
  {
    "id": "check_app_insights",
    "category": "telemetry",
    "section": "monitoring",
    "label": "Application Insights configuration",
    "description": "Checks for Application Insights connection settings via env vars or host.json instrumentationKey/connection string.",
    "type": "any_of_exists",
    "required": false,
    "severity": "warning",
    "condition": {
      "targets": ["APPLICATIONINSIGHTS_CONNECTION_STRING", "APPINSIGHTS_INSTRUMENTATIONKEY", "host.json:instrumentationKey"]
    },
    "hint": "Configure Application Insights to get telemetry and diagnostics in production.",
    "hint_url": "https://learn.microsoft.com/azure/azure-monitor/app/azure-functions",
    "check_order": 24
  },
  {
    "id": "check_extension_bundle",
    "category": "configuration",
    "section": "extensions",
    "label": "extensionBundle / binding extensions",
    "description": "Validate that extensionBundle is configured in host.json or required binding extensions are present.",
    "type": "host_json_property",
    "required": false,
    "severity": "error",
    "condition": {
      "jsonpath": "$.extensionBundle"
    },
    "hint": "Use extensionBundle to ensure required extensions are available for bindings.",
    "hint_url": "https://learn.microsoft.com/azure/azure-functions/functions-extension-bundles",
    "check_order": 25
  },
  {
    "id": "check_asgi_wsgi_exposure",
    "category": "framework",
    "section": "asgi_wsgi",
    "label": "ASGI/WSGI compatibility",
    "description": "Detect whether the project exposes ASGI/WSGI callable and whether it's wired correctly for Functions host.",
    "type": "callable_detection",
    "required": false,
    "severity": "warning",
    "condition": {},
    "hint": "Verify ASGI/WSGI app is exposed as expected; misconfiguration can prevent routing or startup.",
    "hint_url": "https://learn.microsoft.com/azure/azure-functions/functions-reference-python#asgi",
    "check_order": 26
  },
  {
    "id": "check_unused_files",
    "category": "project_health",
    "section": "cleanup",
    "label": "Detect unused or invalid files",
    "description": "Detect common unwanted files in project root or deployment (e.g., .pyc, __pycache__, .venv, tests).",
    "type": "file_glob_check",
    "required": false,
    "severity": "info",
    "condition": {
      "patterns": ["**/__pycache__", "**/*.pyc", ".venv", "tests/"]
    },
    "hint": "Remove or exclude unwanted files from deployment to reduce package size and avoid accidental secrets.",
    "check_order": 30
  }
]